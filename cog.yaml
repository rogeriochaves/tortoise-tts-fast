# Configuration for Cog ⚙️
# Reference: https://github.com/replicate/cog/blob/main/docs/yaml.md
# image: "r8.im/neonbjb/tortoise-tts"
image: "r8.im/afiaka87/tortoise-tts"
build:
  gpu: true
  cuda: "11.3"

  system_packages:
    - libsndfile-dev
    - ffmpeg

  python_version: "3.8"
  python_packages:
    - "accelerate==0.17.0"
    - "altair==4.2.2"
    - "appdirs==1.4.4"
    - "attrs==22.2.0"
    - "audioread==3.0.0"
    - "auraloss==0.3.0"
    - "backports-zoneinfo==0.2.1"
    - "beautifulsoup4==4.11.2"
    - "blinker==1.5"
    - "boltons==23.0.0"
    - "cachetools==5.3.0"
    - "certifi==2022.12.7"
    - "cffi==1.15.1"
    - "charset-normalizer==3.1.0"
    - "clean-fid==0.1.35"
    - "click==8.1.3"
    - "clip-anytorch==2.5.2"
    - "colorama==0.4.6"
    - "contourpy==1.0.7"
    - "cycler==0.11.0"
    - "decorator==5.1.1"
    - "docker-pycreds==0.4.0"
    - "docstring-parser==0.15"
    - "einops==0.6.0"
    - "entrypoints==0.4"
    - "filelock==3.9.0"
    - "fonttools==4.39.0"
    - "ftfy==6.1.1"
    - "gdown==4.6.4"
    - "gitdb==4.0.10"
    - "gitpython==3.1.31"
    - "huggingface-hub==0.13.1"
    - "idna==3.4"
    - "imageio==2.26.0"
    - "importlib-metadata==6.0.0"
    - "importlib-resources==5.12.0"
    - "inflect==6.0.2"
    - "jinja2==3.1.2"
    - "joblib==1.2.0"
    - "jsonmerge==1.9.0"
    - "jsonschema==4.17.3"
    - "k-diffusion==0.0.14"
    - "kiwisolver==1.4.4"
    - "kornia==0.6.10"
    - "lazy-loader==0.1"
    - "librosa==0.8.1"
    - "llvmlite==0.39.1"
    - "markdown-it-py==2.2"
    - "markupsafe==2.1.2"
    - "matplotlib==3.7.1"
    - "mdurl==0.1.2"
    - "mypy-extensions==1.0.0"
    - "networkx==3.0"
    - "numba==0.56.4"
    - "numpy==1.23.5"
    - "nvidia-cublas-cu11~=11.10"
    - "nvidia-cuda-nvrtc-cu11~=11.0"
    - "nvidia-cuda-runtime-cu11~=11.0"
    - "nvidia-cudnn-cu11~=8.5"
    - "packaging==23.0"
    - "pandas==1.5.3"
    - "pathtools==0.1.2"
    - "pesq==0.0.4"
    - "pillow==9.4.0"
    - "pkgutil-resolve-name~=1.3"
    - "platformdirs==3.1.1"
    - "pooch==1.7.0"
    - "progressbar==2.5"
    - "protobuf==3.20.3"
    - "psutil==5.9.4"
    - "pyarrow==11.0.0"
    - "pycparser==2.21"
    - "pydantic==1.10.6"
    - "pydeck==0.8.0"
    - "pygments==2.14.0"
    - "pympler==1.0.1"
    - "pyparsing==3.0.9"
    - "pyrsistent==0.19.3"
    - "pysocks==1.7.1"
    - "python-dateutil==2.8.2"
    - "pytz-deprecation-shim==0.1"
    - "pytz==2022.7.1"
    - "pywavelets==1.4.1"
    - "pyyaml==6.0"
    - "regex==2022.10.31"
    - "requests==2.28.2"
    - "requests[socks]==2.28.2"
    - "resampy==0.4.2"
    - "resize-right==0.0.2"
    - "rich==13.3.2"
    - "rotary-embedding-torch~=0.2"
    - "scikit-image==0.20.0"
    - "scikit-learn==1.2.2"
    - "scipy~=1.8.0"
    - "semver==2.13.0"
    - "sentry-sdk==1.16.0"
    - "setproctitle==1.3.2"
    - "setuptools==67.6.0"
    - "simple-parsing==0.0.21"
    - "six==1.16.0"
    - "smmap==5.0.0"
    - "soundfile==0.12.1"
    - "soupsieve==2.4"
    - "streamlit==1.20.0"
    - "threadpoolctl==3.1.0"
    - "tifffile==2023.2.28"
    - "tokenizers==0.13.2"
    - "toml==0.10.2"
    - "toolz==0.12.0"
    - "torch==1.13.1"
    - "torchaudio==0.13.1"
    - "torchdiffeq==0.2.3"
    - "torchlibrosa==0.0.7"
    - "torchsde==0.2.5"
    - "torchvision==0.14.1"
    - "tornado==6.2"
    - "tqdm==4.65.0"
    - "trampoline==0.1.2"
    - "transformers==4.26.1"
    - "typing-extensions==4.5.0"
    - "typing-inspect==0.8.0"
    - "tzdata==2022.7"
    - "tzlocal==4.2"
    - "unidecode==1.3.6"
    - "urllib3==1.26.15"
    - "validators==0.20.0"
    - "voicefixer==0.1.2"
    - "wandb==0.13.11"
    - "watchdog==2.3.1"
    - "wcwidth==0.2.6"
    - "wheel==0.38.4"
    - "zipp==3.15.0"

  run:
    - pip install -e 'git+https://github.com/rogeriochaves/tortoise-tts-fast#egg=TorToiSe'
    - mkdir -p /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/autoregressive.pth' -P /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/classifier.pth' -P /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/clvp2.pth' -P /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/cvvp.pth' -P /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/diffusion_decoder.pth' -P /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/vocoder.pth' -P /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/rlg_auto.pth' -P /root/.cache/tortoise/models/
    - wget -c 'https://huggingface.co/jbetker/tortoise-tts-v2/resolve/main/.models/rlg_diffuser.pth' -P /root/.cache/tortoise/models/

predict: "predict.py:Predictor"